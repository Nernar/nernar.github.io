"use strict";(self.webpackChunkinnercore_docs=self.webpackChunkinnercore_docs||[]).push([[6901],{1787:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"KernelExtension/custom-block-entities","title":"Custom native block entities","description":"Referring to what\'s said in _Defining blocks and items in Java_ article, if the registration of custom blocks and items is at the first place on the list of important Inner Core features which are unfortunately JavaScript-only, the second place on this list is undoubtedly occupied by the tile entities.","source":"@site/libraries/KernelExtension/custom-block-entities.md","sourceDirName":"KernelExtension","slug":"/KernelExtension/custom-block-entities","permalink":"/libraries/KernelExtension/custom-block-entities","draft":false,"unlisted":false,"editUrl":"https://github.com/nernar/nernar.github.io/tree/master/libraries/KernelExtension/custom-block-entities.md","tags":[],"version":"current","lastUpdatedAt":1744569443000,"frontMatter":{},"sidebar":"librariesSidebar","previous":{"title":"JSON block and item models","permalink":"/libraries/KernelExtension/json-models"},"next":{"title":"Recipe Viewer","permalink":"/libraries/RecipeViewer"}}');var s=n(4848),o=n(8453);const c={},r="Custom native block entities",l={},a=[{value:"Defining a custom block entity class",id:"defining-a-custom-block-entity-class",level:2},{value:"<em><strong>The most elementary example:</strong></em>",id:"the-most-elementary-example",level:3},{value:"Registering a new block entity type",id:"registering-a-new-block-entity-type",level:2},{value:"Assigning a block entity to a block",id:"assigning-a-block-entity-to-a-block",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"custom-native-block-entities",children:"Custom native block entities"})}),"\n",(0,s.jsxs)(t.p,{children:["Referring to what's said in ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.em,{children:(0,s.jsx)(t.code,{children:"Defining blocks and items in Java"})})})," ",(0,s.jsx)(t.a,{href:"/libraries/KernelExtension/blocks-and-items-in-java",children:"article"}),", if the registration of custom blocks and items is at the first place on the list of important Inner Core features which are unfortunately ",(0,s.jsx)(t.em,{children:"JavaScript-only"}),", the second place on this list is undoubtedly occupied by ",(0,s.jsx)(t.strong,{children:"the tile entities"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"custom native block entities class system"})," introduced in KEX ",(0,s.jsx)(t.code,{children:"RELEASE 4.0"})," covers two cons of Inner Core's tile entities at the same time, first being impossibility of working with them in Java, and the second being relatively poor performance because of the 100%-JavaScript implementation."]}),"\n",(0,s.jsx)(t.p,{children:"The Java block entities are registered in native code as new types of vanilla tiles (the same way as things like chest, hopper, brewing stand, furnace etc.). Each Java block entity instance is linked to a corresponding native tile object. Minecraft itself calls most of the key methods, while Java object being just a mod-developer-defined set of those methods."}),"\n",(0,s.jsx)(t.h2,{id:"defining-a-custom-block-entity-class",children:"Defining a custom block entity class"}),"\n",(0,s.jsxs)(t.p,{children:["The base Java class for custom native block entities is ",(0,s.jsx)(t.code,{children:"vsdum.kex.modules.tileentity.BlockActor"}),". Despite not having any abstract methods, it is declared as abstract, for you not to set this dummy class as a block entity prototype for some block."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"BlockActor"})," constructor takes three ",(0,s.jsx)(t.strong,{children:"crucial"})," parameters that you necessarily have to put in the ",(0,s.jsx)(t.code,{children:"super"})," call in the constructor of your custom block entity class."]}),"\n",(0,s.jsx)(t.h3,{id:"the-most-elementary-example",children:(0,s.jsx)(t.em,{children:(0,s.jsx)(t.strong,{children:"The most elementary example:"})})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:"package visualstudiodan.kextest;\n\nimport vsdum.kex.modules.tileentity.BlockActor;\nimport vsdum.kex.util.mcmath.BlockPos;\n\npublic class MyBlockEntity extends BlockActor {\n\n    public MyBlockEntity(long ptr, int type, BlockPos blockPos)\n    {\n        super(ptr, type, blockPos);\n    }\n\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"registering-a-new-block-entity-type",children:"Registering a new block entity type"}),"\n",(0,s.jsx)(t.p,{children:"Next step is registering an auto-generated numeric ID of the block entity type for our new block entity class. We will later use this numeric ID to assign this block entity to a certain block that we want."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"TileEntityModule.registerTileEntityType(typeName, callback)"})," method takes the unique string identifier of the block entity (traditionally written in snake case) and the function that will be called every time the custom tile is about to be created, and must return the block entity instance object. This function provides you with that three ",(0,s.jsx)(t.strong,{children:"crucial"})," parameters mentioned before. The method returns a generated numeric ID of the newly registered block entity type. In order to use it, you have to store this ID somewhere. To my mind, the best practice is a ",(0,s.jsx)(t.code,{children:"public static final"})," field."]}),"\n",(0,s.jsx)(t.p,{children:"The basic example how the tile entity creation callback function should look like:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:"new TileEntityCreationCallback() {\n    @Override public BlockActor create(long ptr, int type, BlockPos pos)\n    {\n        return new MyBlockEntity(ptr, type, pos);\n    }\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Using Java 8 lambda syntax, it will be way less bulky:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:"(ptr, type, pos) -> new MyBlockEntity(ptr, type, pos)\n"})}),"\n",(0,s.jsx)(t.p,{children:"Furthermore, in our case we don't need to do anything but to create the block entity object itself, so we can just refer to our block entity class constructor:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:"MyBlockEntity::new\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finally, here's how we register our new block entity type and store its generated numeric ID in a static field:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'public static final int TYPE_ID = TileEntityModule.registerTileEntityType("my_tile", MyBlockEntity::new);\n'})}),"\n",(0,s.jsx)(t.h2,{id:"assigning-a-block-entity-to-a-block",children:"Assigning a block entity to a block"}),"\n",(0,s.jsxs)(t.p,{children:["There are two ways to assign your custom block entity type to a certain block. The first way is using ",(0,s.jsx)(t.code,{children:"TileEntityModule.registerForBlock(blockID, type)"})," method."]}),"\n",(0,s.jsx)(t.p,{children:"You can call it either in Java:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'public class MyBlock extends Block {\n\n    public MyBlock()\n    {\n        super("my_block");\n        // this.addVariation(...), properties, ...\n    }\n\n    static {\n        MyBlock registered = BlockRegistry.register(new MyBlock());\n        TileEntityModule.registerForBlock(registered.getId(), MyBlockEntity.TYPE_ID);\n    }\n\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"... or in JavaScript/TypeScript:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'IDRegistry.genBlockID("my_block");\nBlock.createBlock("my_block", [{...}]);\n\nconst TYPE_ID = WRAP_JAVA("visualstudiodan.kextest.MyBlockEntity").TYPE_ID;\n\nKEX.TileEntityModule.registerForBlock(BlockID.my_block, TYPE_ID);\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The second way, which is exclusive for Java-registered blocks, is implementing the ",(0,s.jsx)(t.code,{children:"IHasBlockActor"})," component:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'public class MyBlock extends Block implements IHasBlockActor {\n\n    public MyBlock()\n    {\n        super("my_block");\n        // this.addVariation(...), properties, ...\n    }\n\n    @Override public int getTileEntityType()\n    {\n        return MyBlockEntity.TYPE_ID;\n    }\n\n    static {\n        BlockRegistry.register(new MyBlock());\n    }\n\n}\n'})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.p,{children:["You can see the list of the base ",(0,s.jsx)(t.code,{children:"BlockActor"})," class methods ",(0,s.jsx)(t.a,{href:"https://dmhyt.github.io/kex-docs/api/interfaces/KEX.TileEntityModule.BlockActor.html",children:"here"})," or by going directly to ",(0,s.jsx)(t.a,{href:"https://github.com/DMHYT/KernelExtension/blob/main/src/java/kernelex/src/vsdum/kex/modules/tileentity/BlockActor.java",children:"BlockActor.java file in KernelExtension public GitHub repository"})]}),"\n",(0,s.jsxs)(t.p,{children:["Lastly, a new ",(0,s.jsx)(t.code,{children:"getCustomBlockEntity"})," ",(0,s.jsx)(t.a,{href:"https://dmhyt.github.io/kex-docs/api/classes/KEX.BlockSource.html#getCustomBlockEntity",children:"method"})," was added to ",(0,s.jsx)(t.code,{children:"ExtendedBlockSource"})," ",(0,s.jsx)(t.a,{href:"https://dmhyt.github.io/kex-docs/api/classes/KEX.BlockSource.html",children:"class"}),", to access the Java instance object of a custom native block entity on given coords, if it's present there."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>r});var i=n(6540);const s={},o=i.createContext(s);function c(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);